import{r as i,j as s,L as P,u as L,a as C,b as F,c as w,g as M,d as k,e as z}from"./index-f8caaf10.js";import{c as p,L as A,O as E}from"./LoadingWrapper-d72521ee.js";import{M as D}from"./Map-33a3f769.js";const x=["Paris","Cologne","Brussels","Amsterdam","Hamburg","Dusseldorf"],H={Amsterdam:{name:"Amsterdam",location:{latitude:52.3909553943508,longitude:4.85309666406198,zoom:13}},Brussels:{name:"Brussels",location:{latitude:50.847767,longitude:4.349394,zoom:13}},Cologne:{name:"Cologne",location:{latitude:50.935994,longitude:6.960506,zoom:13}},Dusseldorf:{name:"Dusseldorf",location:{latitude:51.2277411,longitude:6.7734556,zoom:13}},Hamburg:{name:"Hamburg",location:{latitude:53.55833,longitude:10.025,zoom:13}},Paris:{name:"Paris",location:{latitude:48.8534,longitude:2.3488,zoom:13}}},v=i.memo(t=>{const{active:a,locations:d}=t;return s.jsx("div",{className:"tabs",children:s.jsx("section",{className:"locations container",children:s.jsx("ul",{className:"locations__list tabs__list",children:d.map(c=>s.jsx("li",{className:"locations__item",children:s.jsx(P,{className:p("locations__item-link tabs__item",a===c&&"tabs__item--active"),to:`?city=${c}`,children:s.jsx("span",{children:c})})},c))})})})});v.displayName="LocationsList";const B=t=>{const[a,d]=i.useState(!1),{sorting:c,setSorting:m,options:n}=t;return s.jsxs("form",{className:"places__sorting",action:"#",method:"get",children:[s.jsx("span",{className:"places__sorting-caption",children:"Sort by"}),s.jsxs("span",{className:"places__sorting-type",tabIndex:0,onClick:()=>d(o=>!o),children:[c.value,s.jsx("svg",{className:"places__sorting-arrow",width:"7",height:"4",children:s.jsx("use",{xlinkHref:"#icon-arrow-select"})})]}),s.jsx("ul",{className:p("places__options places__options--custom",a&&"places__options--opened"),children:n.map(o=>s.jsx("li",{className:p("places__option",c.value===o.value&&"places__option--active"),tabIndex:0,onClick:()=>m(o),children:o.value},o.value))})]})},j=[{value:"Popular"},{value:"Price: low to high",compareFunc:(t,a)=>t.price-a.price},{value:"Price: high to low",compareFunc:(t,a)=>a.price-t.price},{value:"Top rated first",compareFunc:(t,a)=>a.rating-t.rating}],I=()=>{const[t]=L(),[a,d]=i.useState(j[0]),[c,m]=i.useState(),n=C(),o=F(),{offers:_,isLoading:N}=w(e=>e.offers),[l,y]=i.useState(t.get("city")||x[0]);i.useEffect(()=>{const e=t.get("city");e&&y(e)},[t]),i.useEffect(()=>{n(M())},[l,n]);const b=i.useCallback(async(e,u)=>{const f=(await n(k({id:e,favorite:u}))).payload;"status"in f&&f.status===401&&o("/login"),await n(z())},[n,o]),S=i.useCallback(e=>{if(!e){m(void 0);return}m({id:e.id,location:e.location})},[]),r=i.useMemo(()=>_[l]||[],[_,l]),g=i.useMemo(()=>a.compareFunc?[...r].sort((e,u)=>a.compareFunc(e,u)):[...r],[a,r]),O=i.useMemo(()=>r.map(e=>({id:e.id,location:e.location})),[r]),h=g.length===0;return s.jsx("div",{className:"page page--gray page--main",children:s.jsxs("main",{className:"page__main page__main--index",children:[s.jsx("h1",{className:"visually-hidden",children:"Cities"}),s.jsx(v,{locations:x,active:l}),s.jsx(A,{isLoading:N,children:s.jsx("div",{className:"cities",children:s.jsxs("div",{className:p("cities__places-container container",h&&"cities__places-container--empty"),children:[h?s.jsx("section",{className:"cities__no-places",children:s.jsxs("div",{className:"cities__status-wrapper tabs__content",children:[s.jsx("b",{className:"cities__status",children:"No places to stay available"}),s.jsxs("p",{className:"cities__status-description",children:["We could not find any property available at the moment in ",l]})]})}):s.jsxs("section",{className:"cities__places places",children:[s.jsx("h2",{className:"visually-hidden",children:"Places"}),s.jsxs("b",{className:"places__found",children:[r.length," places to stay in ",l]}),s.jsx(B,{sorting:a,setSorting:d,options:j}),s.jsx("div",{className:"cities__places-list places__list tabs__content",children:s.jsx(E,{offers:g,changeFavoriteStatus:b,selectOffer:S})})]}),s.jsx("div",{className:"cities__right-section",children:s.jsx(D,{city:H[l],points:O,selectedPoint:c})})]})})})]})})},q=I;export{q as MainPage};
