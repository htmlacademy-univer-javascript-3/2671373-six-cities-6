import{j as s,L as O,r as o,u as P,a as b,b as L,c as C,g as F,d as M,e as w}from"./index-aa50c95b.js";import{c as p,L as z,O as k}from"./LoadingWrapper-8a7bb657.js";import{M as A}from"./Map-405ffa2d.js";const _=["Paris","Cologne","Brussels","Amsterdam","Hamburg","Dusseldorf"],D={Amsterdam:{name:"Amsterdam",location:{latitude:52.3909553943508,longitude:4.85309666406198,zoom:13}},Brussels:{name:"Brussels",location:{latitude:50.847767,longitude:4.349394,zoom:13}},Cologne:{name:"Cologne",location:{latitude:50.935994,longitude:6.960506,zoom:13}},Dusseldorf:{name:"Dusseldorf",location:{latitude:51.2277411,longitude:6.7734556,zoom:13}},Hamburg:{name:"Hamburg",location:{latitude:53.55833,longitude:10.025,zoom:13}},Paris:{name:"Paris",location:{latitude:48.8534,longitude:2.3488,zoom:13}}},E=t=>{const{active:a,locations:d}=t;return s.jsx("div",{className:"tabs",children:s.jsx("section",{className:"locations container",children:s.jsx("ul",{className:"locations__list tabs__list",children:d.map(i=>s.jsx("li",{className:"locations__item",children:s.jsx(O,{className:p("locations__item-link tabs__item",a===i&&"tabs__item--active"),to:`?city=${i}`,children:s.jsx("span",{children:i})})},i))})})})},H=t=>{const[a,d]=o.useState(!1),{sorting:i,setSorting:m,options:n}=t;return s.jsxs("form",{className:"places__sorting",action:"#",method:"get",children:[s.jsx("span",{className:"places__sorting-caption",children:"Sort by"}),s.jsxs("span",{className:"places__sorting-type",tabIndex:0,onClick:()=>d(c=>!c),children:[i.value,s.jsx("svg",{className:"places__sorting-arrow",width:"7",height:"4",children:s.jsx("use",{xlinkHref:"#icon-arrow-select"})})]}),s.jsx("ul",{className:p("places__options places__options--custom",a&&"places__options--opened"),children:n.map(c=>s.jsx("li",{className:p("places__option",i.value===c.value&&"places__option--active"),tabIndex:0,onClick:()=>m(c),children:c.value},c.value))})]})},h=[{value:"Popular"},{value:"Price: low to high",compareFunc:(t,a)=>t.price-a.price},{value:"Price: high to low",compareFunc:(t,a)=>a.price-t.price},{value:"Top rated first",compareFunc:(t,a)=>a.rating-t.rating}],B=()=>{const[t]=P(),[a,d]=o.useState(h[0]),[i,m]=o.useState(),n=b(),c=L(),{offers:g,isLoading:x}=C(e=>e.offers),[l,v]=o.useState(t.get("city")||_[0]);o.useEffect(()=>{const e=t.get("city");e&&v(e)},[t]),o.useEffect(()=>{n(F())},[l,n]);const j=async(e,u)=>{const f=(await n(M({id:e,favorite:u}))).payload;"status"in f&&f.status===401&&c("/login"),await n(w())},N=e=>{if(!e){m(void 0);return}m({id:e.id,location:e.location})},r=o.useMemo(()=>g[l]||[],[g,l]),S=o.useMemo(()=>a.compareFunc?[...r].sort((e,u)=>a.compareFunc(e,u)):[...r],[a,r]),y=o.useMemo(()=>r.map(e=>({id:e.id,location:e.location})),[r]);return s.jsx("div",{className:"page page--gray page--main",children:s.jsxs("main",{className:"page__main page__main--index",children:[s.jsx("h1",{className:"visually-hidden",children:"Cities"}),s.jsx(E,{locations:_,active:l}),s.jsx(z,{isLoading:x,children:s.jsx("div",{className:"cities",children:s.jsxs("div",{className:"cities__places-container container",children:[s.jsxs("section",{className:"cities__places places",children:[s.jsx("h2",{className:"visually-hidden",children:"Places"}),s.jsxs("b",{className:"places__found",children:[r.length," places to stay in ",l]}),s.jsx(H,{sorting:a,setSorting:d,options:h}),s.jsx("div",{className:"cities__places-list places__list tabs__content",children:s.jsx(k,{offers:S,changeFavoriteStatus:j,selectOffer:N})})]}),s.jsx("div",{className:"cities__right-section",children:s.jsx(A,{city:D[l],points:y,selectedPoint:i})})]})})})]})})},W=B;export{W as MainPage};
